# Что такое DAN ?

# DAN (Dynamic Adaptive Network) — это протокол организации доступа к среде передачи на базе динамического TDMA, позволяющий узлам в сети автоматически перестраиваться при изменении количества устройств. 

# Суть идеи:
    Мы делим общий кадр (например, 100 мс) на N+1N+1 слотов, где NN — 
    текущее количество узлов, а «+1» — это зарезервированный (guard) слот.
    Каждый узел получает свой слот для передачи (broadcast). В этом слоте
    он посылает свои данные (координаты, служебную информацию и т.д.).
    Guard slot (промежуток тишины) используется для новых узлов, которые
    хотят «присоединиться» в сеть. Если новый узел слышит в эфире, что NN узлов,
    то он ждет этого «тихого слота» и передает «join request».
    Остальные узлы (получив join request) увеличивают NN на 1, и, 
    начиная со следующего кадра, все перестраиваются: теперь кадр делится 
    на (N+1)+1=N+2(N+1)+1=N+2 слотов, а новый узел получает «свой» слот и может передавать. 
    Таким образом, система автоматически адаптируется при увеличении/уменьшении числа узлов в сети.
    
# 2. Отличия DAN от классических схем :

    2.1. Сравнение с фиксированным TDMA
        Фиксированное TDMA (Static TDMA): обычно мы заранее знаем число узлов
        NN и делим кадр на NN (или N+kN+k) слотов.
            Проблема: если количество узлов меняется, нужна ручная перенастройка.
            Если узлов стало меньше, часть слотов пропадает зря; если больше, 
            не хватает слотов и возникают коллизии.
        DAN: slots пересчитываются «на лету» при добавлении/удалении узлов,
        что даёт гибкость.
    
    2.2. Сравнение с CSMA/CA (или ALOHA)
        CSMA-подобный протокол (Carrier Sense Multiple Access) не требует распределения слотов,
        узлы пытаются передавать, избегая коллизий методами «слушаю перед отправкой».
            Проблема: При большой загрузке вероятность коллизий растет, могут быть задержки непредсказуемые.
        DAN: гарантированно нет коллизий (каждый узел имеет свой чёткий слот),
        и при этом автоматически добавляются новые узлы.
    
    2.3. Сравнение с Master-Slave (централизованными) системами
        Централизованные (например, один «master» выдает опрос, «slave» отвечают по очереди).
            Здесь всё зависит от главного узла. Если он отключится, сеть рухнет.
        DAN: децентрализован. Нет явного «мастера»: каждый узел «знает» NN и свой номер.
        При появлении нового узла все узлы сообща увеличивают NN.

# 3. Преимущества DAN
    Децентрализованная логика: нет ведущего узла. Каждый самостоятельно вычисляет,
    в какой слот ему передавать.
    Отсутствие коллизий: чёткие временные слоты исключают одновременные передачи,
    если синхронизация времени согласована.
    Автоматическая адаптация к новому узлу:
    при появлении нового модуля в эфире старые узлы просто увеличивают NN,
    и с следующего кадра все знают, что слотов стало N+1N+1.
    Расширяемость: можно добавлять/убирать узлы, не прерывая сеть;
    «guard slot» даёт возможность «вклиниться» в нужный момент.
    Низкая нагрузка на эфир: каждый узел передаёт строго в свой слот, 
    нет избыточного трафика.

# 4. Недостатки DAN
    Требуется точная синхронизация всех узлов по времени.
    TDMA-подход всегда требует согласования «начала кадра», 
    иначе слоты будут «съезжать» и возможны коллизии. 
    Нужно либо периодическое «маячное» сообщение, 
    либо внешняя синхронизация (UWB-метки с точным timing), либо GPS и т.п.
    Сокращение длительности слотов при росте узлов:
    если узлов много, TframeN+1N+1Tframe​​ может стать слишком коротким,
    возможно, узлу не хватит времени отправить пакет.
    Нужно либо увеличивать общий кадр TframeTframe​,
    либо ставить лимит на NN.
    Guard slot может давать коллизии, 
    если несколько новых узлов одновременно пытаются подключиться. 
    Обычно добавляют небольшую рандомную задержку, чтобы они не конфликтовали (CSMA-like).
    Удаление узлов: если узел «вышел», 
    нужно понять (остальные узлы) что его нет (по «тишине» в слоте)
    и перестроить NN (возможно, нужен таймер, чтобы не убирать узел, 
    у которого просто временный сбой).

# 5. Заключение
#DAN — это динамическая TDMA-схема, обеспечивающая:

    Автоматическое добавление/удаление узлов в сеть,
    Децентрализацию (нет главного),
    Отсутствие коллизий (каждый узел имеет слот),

но при этом требует:

    Синхронизации времени,
    Ухудшения «длительности слотов» при большом NN,
    Особой логики «guard slot» и удаления «пропавших» модулей.

Таким образом, DAN является гибким и эффективным решением для ряда задач (UWB-сетей, робототехники, IoT, трекинга), особенно если важно динамически подключать новые узлы и при этом сохранять TDMA-подход без централизованного «мастера».
